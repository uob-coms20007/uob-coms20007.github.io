# Encoding binary trees

The bijection $\phi : \mathbb{N} \times \mathbb{N} \xrightarrow{\cong}
\mathbb{N}$ is unbelievably convenient. For example, using it twice allows us to package three natural numbers together. That is, we can construct a bijection

$$
  \begin{aligned}
  & \phi_3 : \mathbb{N} \times \mathbb{N} \times \mathbb{N} \to \mathbb{N} \\
  & \phi_3(n_1, n_2, n_3) = \phi(n_1, \phi(n_2, n_3))
  \end{aligned}
$$

by applying $\phi$ twice. Naturally, the inverse consists of applying
$\phi^{-1}$ twice:

$$
  \begin{aligned}
  & \phi_3^{-1} : \mathbb{N} \to \mathbb{N} \times \mathbb{N} \times \mathbb{N} \\
  & \phi_3(n) = (n_1, n_2, n_3) \\
  & \quad\quad\quad \text{ where $(n_1, x) = \phi^{-1}(n)$ and $(n_2, n_3) = \phi^{-1}(x)$}
  \end{aligned}
$$

This can then be used to encode binary trees.
[Recall](https://uob-coms20007.github.io/reference/while/abstract-syntax.html#denoting-abstract-syntax-linearly-backus-naur-form)
that the set $T$ of __binary trees (decorated with natural numbers)__ is
generated by the Backus-Naur form

$$
t_1, t_2, \dots :≔\ \text{•}\ \mid \ \textsf{fork}(n, t_1, t_2)
$$

where we write $\text{•}$ to denote the empty tree, and $\textsf{fork}(n,
t_1, t_2)$ to denote the tree decorated with a natural number $n \in
\mathbb{N}$, and with left subtree $t_1 \in T$, and right subtree $t_2 \in
T$.

This set $T$ can then be put in bijection with the natural numbers as
follows. We define a function $\phi_T : T \to \mathbb{N}$ by induction on
trees:

$$
  \begin{aligned}
    \phi_T(\text{•})                   &= 0 \\
    \phi_T(\textsf{fork}(n, t_1, t_2)) &= 1 + \phi(n, \phi(\phi_T(t_1), \phi_T(t_2)))
  \end{aligned}
$$

This encoding combines the ideas used to encode
[lists](https://uob-coms20007.github.io/reference/computability/encodings.html#encoding-lists)
with the ideas used to encode triples of natural numbers.

It is not difficult to write down the inverse; we recommend it as a
proverbial exercise for the reader.
